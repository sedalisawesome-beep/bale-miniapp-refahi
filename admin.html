<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>پنل مدیریت - مراکز رفاهی</title>
    <link rel="stylesheet" href="admin.css">
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-screen">
        <div class="login-container">
            <div class="login-header">
                <h1>🔐 ورود به پنل مدیریت</h1>
                <p>مراکز رفاهی و خدماتی استان تهران</p>
            </div>
            <form id="loginForm" class="login-form">
                <div class="form-group">
                    <label for="username">نام کاربری</label>
                    <input type="text" id="username" required autocomplete="username">
                </div>
                <div class="form-group">
                    <label for="password">رمز عبور</label>
                    <input type="password" id="password" required autocomplete="current-password">
                </div>
                <div id="loginError" class="error-message" style="display: none;"></div>
                <button type="submit" class="btn-primary">ورود</button>
            </form>
        </div>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" class="admin-panel" style="display: none;">
        <!-- Header -->
        <header class="admin-header">
            <div class="header-content">
                <h1>پنل مدیریت مراکز</h1>
                <button id="logoutBtn" class="btn-logout">خروج 🚪</button>
            </div>
        </header>

        <!-- Stats -->
        <div class="stats-container">
            <div class="stat-box">
                <div class="stat-number" id="totalCentersAdmin">0</div>
                <div class="stat-label">کل مراکز</div>
            </div>
            <div class="stat-box">
                <div class="stat-number">6</div>
                <div class="stat-label">دسته‌بندی</div>
            </div>
        </div>

        <!-- Add Center Button -->
        <div class="actions-bar">
            <button id="addCenterBtn" class="btn-add">
                ➕ افزودن مرکز جدید
            </button>
            <button id="importDataBtn" class="btn-secondary">
                📥 بارگذاری داده‌های اولیه
            </button>
            <button id="manageUsersBtn" class="btn-secondary" style="display: none;">
                👥 مدیریت کاربران
            </button>
        </div>

        <!-- Filters -->
        <div class="filters-bar">
            <select id="provinceFilterAdmin" class="filter-select">
                <option value="all">همه استان‌ها</option>
                <option value="tehran">تهران</option>
                <option value="gilan">گیلان</option>
                <option value="azarbayjan_sharghi">آذربایجان شرقی</option>
                <option value="azarbayjan_gharbi">آذربایجان غربی</option>
                <option value="kermanshah">کرمانشاه</option>
                <option value="khuzestan">خوزستان</option>
                <option value="fars">فارس</option>
                <option value="esfahan">اصفهان</option>
                <option value="khorasan_razavi">خراسان رضوی</option>
                <option value="qazvin">قزوین</option>
                <option value="semnan">سمنان</option>
                <option value="qom">قم</option>
                <option value="markazi">مرکزی</option>
                <option value="zanjan">زنجان</option>
                <option value="mazandaran">مازندران</option>
                <option value="golestan">گلستان</option>
                <option value="ardabil">اردبیل</option>
                <option value="yazd">یزد</option>
                <option value="kerman">کرمان</option>
                <option value="hormozgan">هرمزگان</option>
                <option value="lorestan">لرستان</option>
                <option value="ilam">ایلام</option>
                <option value="kohgiluyeh">کهگیلویه و بویراحمد</option>
                <option value="bushehr">بوشهر</option>
                <option value="sistan">سیستان و بلوچستان</option>
                <option value="kurdistan">کردستان</option>
                <option value="hamedan">همدان</option>
                <option value="chaharmahal">چهارمحال و بختیاری</option>
                <option value="khorasan_shomali">خراسان شمالی</option>
                <option value="khorasan_jonubi">خراسان جنوبی</option>
                <option value="alborz">البرز</option>
            </select>
            <select id="categoryFilterAdmin" class="filter-select">
                <option value="all">همه دسته‌ها</option>
                <option value="restaurant">رستوران‌ها</option>
                <option value="clothing">پوشاک</option>
                <option value="medical">مراکز درمانی</option>
                <option value="pool">استخرها</option>
                <option value="welfare">رفاهی و خدماتی</option>
                <option value="optical">عینک فروشی</option>
            </select>
            <input type="text" id="searchAdmin" placeholder="جستجو..." class="search-input">
        </div>

        <!-- Centers List -->
        <div id="centersList" class="centers-list">
            <!-- Centers will be loaded here -->
        </div>
    </div>

    <!-- Add/Edit Modal -->
    <div id="centerModal" class="modal" style="display: none;">
        <div class="modal-overlay"></div>
        <div class="modal-dialog">
            <div class="modal-header">
                <h2 id="modalTitle">افزودن مرکز جدید</h2>
                <button class="modal-close" id="modalClose">✕</button>
            </div>
            <form id="centerForm" class="modal-body">
                <div class="form-group">
                    <label for="centerProvince">استان *</label>
                    <select id="centerProvince" required>
                        <option value="">انتخاب کنید...</option>
                        <option value="tehran">تهران</option>
                        <option value="gilan">گیلان</option>
                        <option value="azarbayjan_sharghi">آذربایجان شرقی</option>
                        <option value="azarbayjan_gharbi">آذربایجان غربی</option>
                        <option value="kermanshah">کرمانشاه</option>
                        <option value="khuzestan">خوزستان</option>
                        <option value="fars">فارس</option>
                        <option value="esfahan">اصفهان</option>
                        <option value="khorasan_razavi">خراسان رضوی</option>
                        <option value="qazvin">قزوین</option>
                        <option value="semnan">سمنان</option>
                        <option value="qom">قم</option>
                        <option value="markazi">مرکزی</option>
                        <option value="zanjan">زنجان</option>
                        <option value="mazandaran">مازندران</option>
                        <option value="golestan">گلستان</option>
                        <option value="ardabil">اردبیل</option>
                        <option value="yazd">یزد</option>
                        <option value="kerman">کرمان</option>
                        <option value="hormozgan">هرمزگان</option>
                        <option value="lorestan">لرستان</option>
                        <option value="ilam">ایلام</option>
                        <option value="kohgiluyeh">کهگیلویه و بویراحمد</option>
                        <option value="bushehr">بوشهر</option>
                        <option value="sistan">سیستان و بلوچستان</option>
                        <option value="kurdistan">کردستان</option>
                        <option value="hamedan">همدان</option>
                        <option value="chaharmahal">چهارمحال و بختیاری</option>
                        <option value="khorasan_shomali">خراسان شمالی</option>
                        <option value="khorasan_jonubi">خراسان جنوبی</option>
                        <option value="alborz">البرز</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="centerName">نام مرکز *</label>
                    <input type="text" id="centerName" required>
                </div>

                <div class="form-group">
                    <label for="centerCategory">دسته‌بندی *</label>
                    <select id="centerCategory" required>
                        <option value="">انتخاب کنید...</option>
                        <option value="restaurant">رستوران‌ها</option>
                        <option value="clothing">پوشاک</option>
                        <option value="medical">مراکز درمانی</option>
                        <option value="pool">استخرها</option>
                        <option value="welfare">رفاهی و خدماتی</option>
                        <option value="optical">عینک فروشی</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="centerType">نوع مرکز *</label>
                    <select id="centerType" required>
                        <option value="single">مرکز تکی (با لینک مستقیم)</option>
                        <option value="table">لیست مراکز (جدول)</option>
                    </select>
                </div>

                <div class="form-group" id="urlGroup">
                    <label for="centerUrl">لینک کانال *</label>
                    <input type="url" id="centerUrl" placeholder="https://ble.ir/...">
                </div>

                <div class="form-group" id="tableGroup" style="display: none;">
                    <label>مدیریت لیست مراکز</label>
                    <button type="button" class="btn-secondary" id="manageTableBtn">
                        📋 مدیریت جدول مراکز
                    </button>
                    <small style="color: #666; font-size: 12px; display: block; margin-top: 5px;">
                        تعداد: <span id="tableItemsCount">0</span> مرکز
                    </small>
                </div>

                <div class="form-group">
                    <label for="centerAddress">آدرس</label>
                    <input type="text" id="centerAddress" placeholder="آدرس دقیق مرکز (اختیاری)">
                </div>

                <div class="form-group">
                    <label for="centerPhone">تلفن</label>
                    <input type="tel" id="centerPhone" placeholder="021-12345678 (اختیاری)">
                </div>

                <div class="form-group">
                    <label for="centerImage">عکس مرکز</label>
                    <input type="file" id="centerImage" accept="image/*">
                    <div id="imagePreview" class="image-preview" style="display: none;">
                        <img id="previewImg" src="" alt="پیش‌نمایش">
                        <button type="button" class="btn-remove-image" id="removeImage">✕ حذف عکس</button>
                    </div>
                </div>

                <div class="form-group">
                    <label for="centerLocation">لینک موقعیت مکانی (Google Maps)</label>
                    <input type="url" id="centerLocation" placeholder="https://maps.google.com/... (اختیاری)">
                    <small style="color: #666; font-size: 12px;">💡 از Google Maps لینک موقعیت را کپی کنید</small>
                </div>

                <div class="form-group">
                    <label for="centerRating">امتیاز (ستاره)</label>
                    <div class="rating-input">
                        <div class="stars-display" id="starsDisplay">
                            <span class="star" data-rating="1">☆</span>
                            <span class="star" data-rating="2">☆</span>
                            <span class="star" data-rating="3">☆</span>
                            <span class="star" data-rating="4">☆</span>
                            <span class="star" data-rating="5">☆</span>
                        </div>
                        <input type="hidden" id="centerRating" value="0">
                        <small style="color: #666; font-size: 12px;">کلیک کنید تا امتیاز دهید (اختیاری)</small>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn-primary">💾 ذخیره</button>
                    <button type="button" class="btn-secondary" id="modalCancel">انصراف</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Table Management Modal -->
    <div id="tableModal" class="modal" style="display: none;">
        <div class="modal-overlay"></div>
        <div class="modal-dialog" style="max-width: 900px;">
            <div class="modal-header">
                <h2>📋 مدیریت جدول مراکز</h2>
                <button class="modal-close" id="tableModalClose">✕</button>
            </div>
            <div class="modal-body">
                <!-- Add Item Form -->
                <div class="table-add-form">
                    <h3>افزودن مرکز جدید</h3>
                    <form id="addTableItemForm" class="table-item-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="itemCity">نام شهر *</label>
                                <input type="text" id="itemCity" required>
                            </div>
                            <div class="form-group">
                                <label for="itemName">نام مرکز *</label>
                                <input type="text" id="itemName" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="itemPhone">شماره تلفن *</label>
                                <input type="tel" id="itemPhone" required placeholder="021-12345678">
                            </div>
                            <div class="form-group">
                                <label for="itemAddress">آدرس *</label>
                                <input type="text" id="itemAddress" required>
                            </div>
                        </div>
                        <button type="submit" class="btn-primary">➕ افزودن به جدول</button>
                    </form>
                </div>

                <!-- Table Items List -->
                <div class="table-items-container">
                    <h3>لیست مراکز (<span id="tableItemsCountModal">0</span>)</h3>
                    <div class="table-responsive">
                        <table id="tableItemsList" class="data-table">
                            <thead>
                                <tr>
                                    <th>ردیف</th>
                                    <th>نام شهر</th>
                                    <th>نام مرکز</th>
                                    <th>شماره تلفن</th>
                                    <th>آدرس</th>
                                    <th>عملیات</th>
                                </tr>
                            </thead>
                            <tbody id="tableItemsBody">
                                <!-- Items will be added here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn-primary" id="saveTableBtn">💾 ذخیره و بستن</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Users Management Modal -->
    <div id="usersModal" class="modal" style="display: none;">
        <div class="modal-overlay"></div>
        <div class="modal-dialog" style="max-width: 900px;">
            <div class="modal-header">
                <h2>👥 مدیریت کاربران</h2>
                <button class="modal-close" id="usersModalClose">✕</button>
            </div>
            <div class="modal-body">
                <div class="users-list-container">
                    <table id="usersTable" class="data-table">
                        <thead>
                            <tr>
                                <th>نام کاربری</th>
                                <th>رمز عبور</th>
                                <th>نقش</th>
                                <th>استان</th>
                                <th>عملیات</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                            <!-- Users will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit User Modal -->
    <div id="editUserModal" class="modal" style="display: none;">
        <div class="modal-overlay"></div>
        <div class="modal-dialog">
            <div class="modal-header">
                <h2>✏️ ویرایش کاربر</h2>
                <button class="modal-close" id="editUserModalClose">✕</button>
            </div>
            <form id="editUserForm" class="modal-body">
                <div class="form-group">
                    <label for="editUsername">نام کاربری *</label>
                    <input type="text" id="editUsername" required>
                </div>

                <div class="form-group">
                    <label for="editPassword">رمز عبور جدید *</label>
                    <input type="text" id="editPassword" required>
                    <small style="color: #666; font-size: 12px;">💡 رمز عبور قوی انتخاب کنید</small>
                </div>

                <div class="form-group">
                    <label>نقش</label>
                    <input type="text" id="editRole" readonly style="background: #f5f5f5;">
                </div>

                <div class="form-group">
                    <label>استان</label>
                    <input type="text" id="editProvince" readonly style="background: #f5f5f5;">
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn-primary">💾 ذخیره تغییرات</button>
                    <button type="button" class="btn-secondary" id="editUserCancel">انصراف</button>
                </div>
            </form>
        </div>
    </div>

    <script src="config.js"></script>
    <script src="admin.js"></script>
</body>
</html>
